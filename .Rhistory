filter(p<0.05)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
group_by(fam, plant, updown) %>%
filter(p<0.05)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
group_by(fam, plant, updown) %>%
filter(p<0.05) %>%
summarise(nr_gene = length(Gene))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
group_by(fam, plant, updown) %>%
filter(p<0.05) %>%
summarise(nr_gene = length(unique(Gene)))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
group_by(fam, plant, updown) %>%
filter(p<0.05)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = length(unique(Gene)))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant) %>%
summarise(nr_gene = length(unique(updown)))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = n(Gene))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = count(Gene))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = tally(Gene))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(Gene))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(p))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct())
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(updown))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(p))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05) %>%
group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI))
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold >0, "up", "down")) %>%
filter(p<0.05)
dat %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI))
aggregate(nr_gene ~ fam + plant + updown, data = dat, FUN = function(x) length(x))
dat
aggregate(AGI ~ fam + plant + updown, data = dat, FUN = function(x) length(x))
rna
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold")
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p")
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
filter(p<0.05)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
filter(p<0.05)  %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down"))
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
filter(p<0.05)  %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down")) %>%
aggregate(AGI ~ fam + plant + updown, data = dat, FUN = function(x) length(x))
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
filter(p<0.05)  %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down"))
aggregate(AGI ~ fam + plant + updown, data = dat, FUN = function(x) length(x))
dat
table(dat$fam)
rna <- read_excel("Documents/Ritwika/RNAseq_cwg_kar.xlsx")
rna[rna$`Gene family` == "arabinogalactan proteins (AGPs)", ]
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox))
head(rna)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p")
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
filter(p < 0.05)
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
filter(p < 0.05)
table(dat$fam)
table(dat$`Gene family`)
dat$`Gene family`
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p")
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p") %>%
filter(p < 0.05)
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
gather(p_value34, p_value_ox, key = "plant", value = "p")
table(dat$`Gene family`)
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold")
table(dat$`Gene family`)
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down"))
table(dat$`Gene family`)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
filter(p_value34 < 0.05 | p_value_ox < 0.05)
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold")
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
rename(fam = 'Gene family')
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down"))
table(dat$fam)
rna <- read_excel("Documents/Ritwika/RNAseq_cwg_kar.xlsx")
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down"))
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down"))
dat[dat$fam == "arabinogalactan proteins (AGP)", ]
dat[dat$fam == "arabinogalactan proteins (AGPs)", ]
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down"))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
# filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, p_value34, p_value34, key = "plant", value = c("logfold", "p"))
rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
# filter(p_value34 < 0.05 | p_value_ox < 0.05)  %>%
gather(Log2_34, Log2_ox, p_value34, p_value34, key = "plant", value = "logfold")
dat <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(Log2_34, Log2_ox, key = "plant", value = "logfold") %>%
rename(fam = 'Gene family') %>%
mutate(updown = ifelse(logfold > 0, "up", "down"))
dat2 <- rna %>%
mutate(p_value34 = as.numeric(p_value34),
p_value_ox = as.numeric(p_value_ox)) %>%
gather(p_value34, p_value_ox, key = "plant", value = "p")
dat2
bind_cols(dat, dat2$p)
cbind(dat, dat2$p)
cbind(dat, P = dat2$p)
dat <- cbind(dat, p = dat2$p)
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dev.off()
pdf("Documents/Ritwika/RNAseq/fig/CWG_families.pdf")
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dev.off()
pdf("Documents/Ritwika/RNAseq/fig/CWG_families.pdf", width = 6, height = 8)
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dev.off()
pdf("Documents/Ritwika/RNAseq/fig/CWG_families.pdf", width = 8, height = 8)
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dev.off()
pdf("Documents/Ritwika/RNAseq/fig/CWG_families.pdf", width = 8, height = 6)
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dev.off()
pdf("Documents/Ritwika/RNAseq/fig/CWG_families.pdf", width = 8, height = 5)
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dev.off()
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
mutate(fam = str_to_sentence(fam)) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ungroup() %>%
mutate(fam = str_to_sentence(fam)) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dev.off()
pdf("Documents/Ritwika/RNAseq/fig/CWG_families.pdf", width = 8, height = 5)
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ungroup() %>%
mutate(fam = str_to_sentence(fam)) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
dev.off()
dat %>% filter(p < 0.05) %>% group_by(fam, plant, updown) %>%
summarise(nr_gene = n_distinct(AGI)) %>%
mutate(mult = ifelse(updown == "down", -1, 1),
nr_gene = mult * nr_gene) %>%
ungroup() %>%
mutate(fam = str_to_sentence(fam)) %>%
rename(Plant = plant) %>%
ggplot(aes(x = fam, y = nr_gene, group = plant, fill = plant)) +
geom_bar(stat = "identity", position = position_dodge()) +
# facet_wrap(~fam, scales = "free_y", ncol = 2) +
coord_flip() +
geom_hline(yintercept = 0) +
labs(y = "Number of genes", x = "Gene families") +
theme_classic()
library(rusda)
devtools::install_github("FranzKrah/rusda")
library(rusda)
a <y- associations(x = "Polyporus badius", spec_type = "fungus")
a <- associations(x = "Polyporus badius", spec_type = "fungus")
a <- associations(x = "Polyporus badius", spec_type = "fungus", db = "both")
a <- associations(x = "Polyporus badius", spec_type = "fungus", database = "both")
a
getStudy()
library(rusda)
setwd("Documents/R/pkgs/rusda/")
roxygen2::roxygenise()
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
roxygen2::roxygenise(clean = TRUE)
